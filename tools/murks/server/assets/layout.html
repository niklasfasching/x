{{ define "[reset]" }}
  <style>
   :where(*), :where(*::before), :where(*::after) {
     box-sizing: border-box;
   }
   :where(*) {
     margin: 0;
   }
   :where(html) {
     block-size: 100%;
     interpolate-size: allow-keywords;
   }
   :where(body) {
     font-family: -apple-system, Roboto, Helvetica, sans-serif;
     line-height: 1.5;
     -webkit-font-smoothing: antialiased;
     min-block-size: 100%;
     color: var(--c-text);
     background: var(--c-bg);
   }
   :where(img, svg) {
     display: block;
     max-width: 100%;
   }
   :where(input, button, textarea, select) {
     font: inherit;
     color: inherit;
   }
   :where(p, h1, h2, h3, h4, h5, h6) {
     overflow-wrap: break-word;
   }
   :where(a) {
     color: inherit;
     text-decoration: none;
   }
   :where(button) {
     background: none;
     border: none;
     cursor: pointer;
     padding: 0;
   }
   [hidden] { display: none !important; }
  </style>
{{ end }}

{{ define "[utilities]" }}
  <style>
   :root {
     --s-1: 0.25rem;
     --s-2: 0.5rem;
     --s-3: 1rem;
     --s-4: 1.5rem;
     --s-5: 2rem;
     --r-sm: 4px;
     --r-md: 6px;
     --r-full: 9999px;
     --c-blue: #0071e3;
     --c-blue-dim: rgba(0, 113, 227, 0.08);
     --c-gray: #86868b;
     --c-gray-light: #f5f5f7;
     --c-border: #e5e5ea;
     --c-err: #ff3b30;
     --c-err-dim: rgba(255, 59, 48, 0.08);
     --c-warn: #ff9500;
     --c-warn-dim: rgba(255, 149, 0, 0.08);
     --c-ok: #34c759;
     --c-ok-dim: rgba(52, 199, 89, 0.08);
     --c-text: #1d1d1f;
     --c-bg: #ffffff;
     --sh-sm: 0 1px 2px rgba(0,0,0,0.05);
     --sh-up: 0 -10px 40px rgba(0,0,0,0.1);
   }

   .stack {
     display: flex;
     flex-direction: column;
     justify-content: flex-start;
     & > * + * { margin-top: var(--gap, var(--s-3)); }
   }

   .cluster {
     display: flex;
     flex-wrap: wrap;
     gap: var(--gap, var(--s-2));
     align-items: center;
     &.between { justify-content: space-between; }
     &.center { justify-content: center; }
   }

   .sidebar {
     display: flex;
     flex-wrap: wrap;
     gap: var(--gap, var(--s-3));
     & > :first-child {
       flex-basis: var(--side-w, 20ch);
       flex-grow: 1;
     }
     & > :last-child {
       flex-basis: 0;
       flex-grow: 999;
       min-inline-size: 50%;
     }
   }

   .center {
     display: grid;
     place-items: center;
   }

   .frame {
     display: flex;
     align-items: center;
     justify-content: center;
     overflow: hidden;
     &.icon {
       width: 44px;
       height: 44px;
       flex-shrink: 0;
     }
   }

   .layer {
     position: fixed;
     inset: 0;
     z-index: var(--z, 10);
   }

   .gap-1 { --gap: var(--s-1); }
   .gap-2 { --gap: var(--s-2); }
   .gap-3 { --gap: var(--s-3); }
   .gap-4 { --gap: var(--s-4); }
   .p-2 { padding: var(--s-2); }
   .p-3 { padding: var(--s-3); }
   .p-4 { padding: var(--s-4); }
   .px-3 { padding-inline: var(--s-3); }
   .py-2 { padding-block: var(--s-2); }
   .m-auto { margin: auto; }
   .mt-4 { margin-top: var(--s-4); }
   .mb-4 { margin-bottom: var(--s-4); }
   .rounded { border-radius: var(--r-md); }
   .rounded-full { border-radius: var(--r-full); }
   .border { border: 1px solid var(--c-border); }
   .border-b { border-bottom: 1px solid var(--c-border); }
   .shadow-sm { box-shadow: var(--sh-sm); }
   .text-sm { font-size: 0.85rem; }
   .text-xs { font-size: 0.75rem; }
   .bold { font-weight: 600; }
   .mono { font-family: ui-monospace, SFMono-Regular, monospace; }

   .text-gray { color: var(--c-gray); }
   .text-err { color: var(--c-err); }
   .ellipsis {
     white-space: nowrap;
     overflow: hidden;
     text-overflow: ellipsis;
   }

   .bg-white { background: white; }
   .bg-gray-light { background: var(--c-gray-light); }
   .bg-blue-dim {
     background: var(--c-blue-dim);
     color: var(--c-blue);
     border-color: var(--c-blue);
   }
   .bg-warn-dim {
     background: var(--c-warn-dim);
     color: var(--c-warn);
     border-color: var(--c-warn);
   }
   .bg-ok-dim {
     background: var(--c-ok-dim);
     color: var(--c-ok);
     border-color: var(--c-ok);
   }

   .btn {
     display: inline-flex;
     align-items: center;
     gap: var(--s-2);
     padding: var(--s-2) var(--s-3);
     border-radius: var(--r-md);
     font-weight: 600;
     font-size: 0.9rem;
     transition: 0.1s;
     &:active { transform: scale(0.98); }
     &.primary {
       background: #000;
       color: #fff;
     }
     &.secondary {
       background: #fff;
       color: #000;
       border: 1px solid var(--c-border);
       &:hover { background: var(--c-gray-light); }
     }

     &.ghost {
       color: var(--c-text);
       opacity: 0.6;
       &:hover {
         opacity: 1;
         background: var(--c-gray-light);
       }
       &.err:hover {
         color: var(--c-err);
         background: var(--c-err-dim);
       }
     }
   }

   .input {
     display: block;
     width: 100%;
     padding: var(--s-2) var(--s-3);
     border: 1px solid var(--c-border);
     border-radius: var(--r-md);
     font-size: 0.9rem;
     background: var(--c-bg);
     color: var(--c-text);
     transition: border-color 0.2s;

     &:focus {
       outline: none;
       border-color: var(--c-blue);
     }
   }

   .toggle {
     width: 36px;
     height: 36px;
     display: flex;
     align-items: center;
     justify-content: center;
     border-radius: var(--r-md);
     border: 1px solid var(--c-border);
     color: var(--c-gray);
     transition: 0.2s;
     &:hover:not([disabled]) {
       color: #000;
       background: var(--c-gray-light);
     }
     &.active {
       background: var(--c-blue-dim);
       color: var(--c-blue);
       border-color: var(--c-blue);
       opacity: 1;
       &.warn {
         background: var(--c-warn-dim);
         color: var(--c-warn);
         border-color: var(--c-warn);
       }
       &.ok {
         background: var(--c-ok-dim);
         color: var(--c-ok);
         border-color: var(--c-ok);
       }
     }
     &[disabled] {
       opacity: 0.5;
       cursor: default;
     }
   }

   .container {
     width: min(600px, 100% - var(--s-4));
     margin-inline: auto;
   }

   .section-header { text-transform: uppercase; letter-spacing: 0.05em; margin-top: 1em; }
   .entry-link { min-width: 0; text-decoration: none; }
   .my-2 { margin-block: var(--s-2); }
  </style>
{{ end }}


{{ define "<layout>" }}
  <template>
    <!DOCTYPE html>
    <html lang="en">
      <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>{{ api.Domain}}</title>
        {{ template "[reset]" . }}
        {{ template "[utilities]" . }}
        {{ template "[assets]" .name }}
        <script>{{ template "toast-js" . }}</script>
      </head>
      <body class="stack gap-4 container py-2">
        <header class="cluster between py-2 mb-4">
          <a href="{{ api.URL "" }}" class="bold"
             style="font-size: 1.5rem; letter-spacing: -0.02em;">{{api.Domain}}</a>
          {{ if .user }}
            <form method="POST" action="/login" onsubmit="return confirm('Log out?')">
              <input type="hidden" name="token" value="">
              <button class="mono text-sm text-gray" style="padding: 8px 0;" title="Click to Log Out">@{{.user}}</button>
            </form>
          {{ end }}
        </header>
        {{ .slots.rest }}
        <app-options isadmin={{ .isadmin }} />
      </body>
    </html>
  </template>
{{ end }}
